Author: Ben Reser <breser@apache.org>
Subject: Disallow methods other than GET/HEAD for the parentpath list.

Fixes the segfault for `svn ls http://svn.example.com` when SVN is handling
the server root and SVNListParentPath is on.

Origin: upstream, backported from commit:r1557320
Bug-CVE: http://subversion.apache.org/security/CVE-2014-0032-advisory.txt
Bug-Debian: http://bugs.debian.org/737815
Last-Update: 2014-02-26

--- a/subversion/mod_dav_svn/repos.c
+++ b/subversion/mod_dav_svn/repos.c
@@ -1655,6 +1655,19 @@
 
       if (strcmp(parentpath, uri) == 0)
         {
+          /* Only allow GET and HEAD on the parentpath resource
+           * httpd uses the same method_number for HEAD as GET */
+          if (r->method_number != M_GET)
+            {
+              /* can't use r->allowed since the default handler isn't called */
+              apr_table_setn(r->headers_out, "Allow", "GET,HEAD");
+
+              return dav_new_error(r->pool, HTTP_METHOD_NOT_ALLOWED,
+                                   SVN_ERR_APMOD_MALFORMED_URI,
+                                   "The URI does not contain the name "
+                                   "of a repository.");
+            }
+
           err = get_parentpath_resource(r, root_path, resource);
           if (err)
             return err;
